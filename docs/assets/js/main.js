"use strict";const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result}fileField.addEventListener("change",getImage);const btnCreated=document.querySelector(".js-btnCreated"),hiddenCreated=document.querySelector(".js-hidden");function handleClickCreated(e){e.preventDefault(),btnCreated.disabled=!0,btnCreated.classList.add("grey")}btnCreated.addEventListener("click",handleClickCreated);const colorPaletteOne=document.querySelector(".color_palette_1"),colorPaletteTwo=document.querySelector(".color_palette_2"),colorPaletteThree=document.querySelector(".color_palette_3"),colorPaletteFour=document.querySelector(".color_palette_4"),pepinoPreview=document.querySelector(".js__profile-preview"),card=document.querySelector(".js_card");function handleColorOne(){card.classList.remove("card--palette2"),card.classList.remove("card--palette3"),card.classList.remove("card--palette4"),card.classList.remove("card--palette5"),card.classList.remove("card--palette6"),card.classList.add("card--palette1"),data.palette=1,card.classList.contains("card--palette1")&&(pepinoPreview.classList.remove("card__image2"),pepinoPreview.classList.add("card__image1"))}function handleColorTwo(){card.classList.remove("card--palette1"),card.classList.remove("card--palette3"),card.classList.remove("card--palette4"),card.classList.remove("card--palette5"),card.classList.remove("card--palette6"),card.classList.add("card--palette2"),data.palette=2,card.classList.contains("card--palette2")&&(pepinoPreview.classList.remove("card__image3"),pepinoPreview.classList.remove("card__image2"),pepinoPreview.classList.add("card__image1"))}function handleColorThree(){card.classList.remove("card--palette1"),card.classList.remove("card--palette2"),card.classList.remove("card--palette4"),card.classList.remove("card--palette5"),card.classList.remove("card--palette6"),card.classList.add("card--palette3"),data.palette=3,card.classList.contains("card--palette3")&&(pepinoPreview.classList.remove("card__image3"),pepinoPreview.classList.remove("card__image1"),pepinoPreview.classList.add("card__image2"))}function handleColorFour(){card.classList.remove("card--palette1"),card.classList.remove("card--palette2"),card.classList.remove("card--palette3"),card.classList.remove("card--palette5"),card.classList.remove("card--palette6"),card.classList.add("card--palette4"),data.palette=4,card.classList.contains("card--palette4")&&(pepinoPreview.classList.remove("card__image2"),pepinoPreview.classList.remove("card__image1"),pepinoPreview.classList.add("card__image3"))}colorPaletteOne.addEventListener("click",handleColorOne),colorPaletteTwo.addEventListener("click",handleColorTwo),colorPaletteThree.addEventListener("click",handleColorThree),colorPaletteFour.addEventListener("click",handleColorFour);const form=document.querySelector(".js-currentTarget"),designForm=document.querySelector(".js_design_form"),fillForm=document.querySelector(".js_fill_form"),shareForm=document.querySelector(".js_share_form");function openDiv(e){e.classList.remove("collapsed"),e===designForm?(fillForm.classList.add("collapsed"),shareForm.classList.add("collapsed")):e===fillForm?(designForm.classList.add("collapsed"),shareForm.classList.add("collapsed")):e===shareForm&&(designForm.classList.add("collapsed"),fillForm.classList.add("collapsed"))}function handleClickLegend(e){(e.target.classList.contains("form__title")||e.target.classList.contains("form__icon"))&&(designForm.contains(e.target)?openDiv(designForm):fillForm.contains(e.target)?openDiv(fillForm):shareForm.contains(e.target)&&openDiv(shareForm))}form.addEventListener("click",handleClickLegend);const buttonReset=document.querySelector(".js_buttonReset"),checkReset=document.querySelector(".js_checkReset");function handleReset(e){e.preventDefault(),nameInput.value="",jobInput.value="",emailInput.value="",phoneInput.value="",linkedinInput.value="",githubInput.value="",namePreviewTitle.innerHTML="Nombre Apellido",jobPreviewTitle.innerHTML="Front-end unicorn",profileImage.style.backgroundImage="",profilePreview.style.backgroundImage="",emailPreviewLink.href="",phonePreviewLink.href="",linkedinPreviewLink.href="",githubPreviewLink.href="",data={palette:1,name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""},checkReset.checked=!0,btnCreated.disabled=!1,hiddenCreated.classList.add("js-hidden"),shareBox.classList.add("js-hidden"),btnCreated.classList.remove("grey"),messageBox.innerHTML="",handleColorOne()}buttonReset.addEventListener("click",handleReset);const nameInput=document.querySelector(".js_name_input"),jobInput=document.querySelector(".js_job_input"),emailInput=document.querySelector(".js_email_input"),phoneInput=document.querySelector(".js_phone_input"),linkedinInput=document.querySelector(".js_linkedin_input"),githubInput=document.querySelector(".js_github_input"),namePreviewTitle=document.querySelector(".js_name_preview"),jobPreviewTitle=document.querySelector(".js_job_preview"),emailPreviewLink=document.querySelector(".js_email_preview"),phonePreviewLink=document.querySelector(".js_phone_preview"),linkedinPreviewLink=document.querySelector(".js_linkedin_preview"),githubPreviewLink=document.querySelector(".js_github_preview");let data={palette:1,name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""};function updatePreview(){namePreviewTitle.innerHTML=data.name.replace("<",""),jobPreviewTitle.innerHTML=data.job.replace("<",""),phonePreviewLink.href="tel:"+data.phone,emailPreviewLink.href="mailto:"+data.email,linkedinPreviewLink.href="https://"+data.linkedin,githubPreviewLink.href="https://github.com/"+data.github.slice(1),""===data.name&&(namePreviewTitle.innerHTML="Nombre Apellido"),""===data.job&&(jobPreviewTitle.innerHTML="Front-end developer")}function handleInputForm(e){"photo"!==e.target.name?(data[e.target.name]=e.target.value,updatePreview()):data[e.target.name]=e.target.files[0]}form.addEventListener("input",handleInputForm);const shareBtn=document.querySelector(".js_shareBtn"),messageBox=document.querySelector(".js_messageBox"),shareBox=document.querySelector(".js_shareBox"),cardLink=document.querySelector(".js_cardLink"),twitterLink=document.querySelector(".js_twitterLink");let dataLS=[];function handleClickShareBtn(e){e.preventDefault(),console.log(data),fetch("https://dev.adalab.es/api/card/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{if(!1===e.success){if(messageBox.innerHTML="Tienes que rellenar todos los datos, amiga.","Database error: ER_DATA_TOO_LONG"===e.error)return void alert("Imagen demasiado grande, prueba con una de menos de 40kb")}else!0===e.success&&(shareBox.classList.remove("js-hidden"),cardLink.href=e.cardURL,cardLink.innerHTML=e.cardURL,e.cardURL,localStorage.setItem("dataForm",JSON.stringify(data)))})}function renderLocalStorage(){console.log("va bien render?"),nameInput.value=data.name,jobInput.value=data.job,console.log("va bien render2"),emailInput.value=data.email,phoneInput.value=data.phone,linkedinInput.value=data.linkedin,githubInput.value=data.github,namePreviewTitle.innerHTML=data.name,jobPreviewTitle.innerHTML=data.job,emailPreviewLink.href=data.email,phonePreviewLink.href=data.phone,linkedinPreviewLink.href=data.linkedin,githubPreviewLink.href=data.github,profileImage.style.backgroundImage=data.photo,profilePreview.style.backgroundImage=data.photo}function getLocalStorage(){console.log("va bien?");let e=JSON.parse(localStorage.getItem("dataForm"));e&&(console.log(e),data=e,renderLocalStorage(),form.addEventListener("submit",e=>{e.preventDefault()}))}shareBtn.addEventListener("click",handleClickShareBtn),window.addEventListener("load",getLocalStorage);